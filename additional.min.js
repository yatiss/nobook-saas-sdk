(function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("lodash"),require("jQuery"));else if("function"==typeof define&&define.amd)define(["lodash","jQuery"],e);else{var o="object"==typeof exports?e(require("lodash"),require("jQuery")):e(t._,t.jQuery);for(var n in o)("object"==typeof exports?exports:t)[n]=o[n]}})(this,function(t,e){return function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=9)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(1),i=window.__nb_saas_sdk_config;e.APPKEY_TEST="111",e.APPSECRET_TEST="weqwew",e.PID_TYPE={PHYSICAL1:"PHYSICAL1",PHYSICAL2:"PHYSICAL2",CHEMICAL1:"CHEMICAL1",CHEMICAL2:"CHEMICAL2",BIOLOGICAL1:"BIOLOGICAL1",BIOLOGICAL2:"BIOLOGICAL2",PHYSICAL_ADD:"PHYSICAL_ADD",CHEMICAL_ADD:"CHEMICAL_ADD"},e.LAB_TYPE_GRADE={PHYSICAL1:1,PHYSICAL2:2,CHEMICAL1:1,CHEMICAL2:2,BIOLOGICAL1:1,BIOLOGICAL2:2},e.PID_VALUE={PHYSICAL1:{lab:"CZWlTE4lVgz9",source:"RESCZWLEeqji"},PHYSICAL2:{lab:"GZWLcJQXfD9W",source:"RESGZWLZoxY5"},CHEMICAL1:{lab:"CZHXNDZHTa75",source:"RESCZHX8afQ1"},CHEMICAL2:{lab:"GZHXXV8IClkO",source:"RESGZHX54req"},BIOLOGICAL1:{source:"JuFhE84jRhEh"},BIOLOGICAL2:{source:"EjEViMk33jNr"},PHYSICAL_ADD:"EXAMQGWLuC5K",CHEMICAL_ADD:"EXAMQGHXuC5K"},e.MESSAGE_TYPE={SAVE_DATA:"PHYSICS_SDK_INTERFACE_SAVE",SAVE_DATA_RESPONSE:"PHYSICS_SDK_INTERFACE_SAVE_RESPONSE",DATA_REQUEST:"PHYSICS_SDK_INTERFACE_DATA_REQUEST",DATA_REQUEST_RESPONSE:"PHYSICS_SDK_INTERFACE_DATA_REQUEST_RESPONSE",NOBOOK_SUBMIT:"nobook.submit",NOBOOK_SUBMIT_RESPONSE:"nobook.submit_response",NOBOOK_ONE_STEP_CORRECT:"nobook.oneStepCorrect",NOBOOK_ONE_STEP_WRONG:"nobook.oneStepWrong",NOBOOK_PRACICE_ONE_TITLE:"nobook.oneStepTitle",NOBOOK_PRACICE_ONE_COMPLETE:"nobook.oneStepComplete",NOBOOK_PRACICE_ONE_PROGRESS:"nobook.oneStepProgress",PHYSICS_SDK_INTERFACE_FRESH_DATA:"PHYSICS_SDK_INTERFACE_FRESH_DATA",ON_LOAD:"onload",ON_LOAD_ERROR:"load_error"},e.GLOBAL_HOST={DOC_HOST:"https://resourceapi.nobook.com",DOC_HOST_DEBUG:"http://resourceapi.nobook.cc"},n.merge(e.GLOBAL_HOST,i),e.GLOBAL_DOCURL={loginURL:"/api/v1/login",logoutURL:"/api/v1/logout"}},function(e,o){e.exports=t},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=o(5),s=o(0),p=o(0),a=o(1),u=function(t){function e(){var e=t.call(this)||this;return e.DOC_DEBUG=!1,e.isMobile=!1,e.token=null,e}return n(e,t),e.prototype.setConfig=function(t){this.debugSettings=t.debugSettings||{},this.DOC_DEBUG=a.get(t,"debugSettings.DOC_DEBUG",!1),this.appKey=t.appKey,this.pidType=t.pidType,this.isMobile=t.isMobile,this.docHost=this.DOC_DEBUG?p.GLOBAL_HOST.DOC_HOST_DEBUG:p.GLOBAL_HOST.DOC_HOST,t.docHost&&(this.docHost=t.docHost);for(var e=0,o=Object.keys(p.GLOBAL_DOCURL);e<o.length;e++){var n=o[e];p.GLOBAL_DOCURL[n]=this.docHost+p.GLOBAL_DOCURL[n]}},e.prototype.login=function(t){var e=this;this.nickname=t.nickname;var o={appKey:this.appKey,uniqueId:t.uniqueId,timestamp:t.timestamp,sign:t.sign,nickname:t.nickname,pidScope:t.pidScope,usertype:0};return this.$post(p.GLOBAL_DOCURL.loginURL,o).then(function(t){var o=t.data;return e.token=o.token,e.uid=o.userinfo.userid,t})},e.prototype.logout=function(){return this.$post(p.GLOBAL_DOCURL.logoutURL,{token:this.token})},e.prototype.$get=function(t,e){return this.$server({method:"get",url:t,param:e})},e.prototype.$post=function(t,e){return this.$server({method:"post",url:t,param:e})},e.prototype.$server=function(t){var e=this;return new Promise(function(o,n){r[t.method](t.url,t.param,function(t,i){if("success"===i){var r=e.jsonObj(t);if(0===r.code){var s=r.data;o({success:!0,data:s})}else n({success:!1,msg:r.msg})}else n({success:!1,msg:i})})})},e.prototype.jsonObj=function(t){return"[object String]"===Object.prototype.toString.call(t)?JSON.parse(t):t},e.prototype.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},Object.defineProperty(e.prototype,"grade",{get:function(){return s.LAB_TYPE_GRADE[this.pidType]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xkType",{get:function(){return this.isPhysical()?"PHYSICAL":this.isChemical()?"CHEMICAL":this.isBiological()?this.pidType:this.isPhysicalAdd()?"PHYSICAL_ADD":this.isChemicalAdd()?"CHEMICAL_ADD":null},enumerable:!0,configurable:!0}),e.prototype.isPhysical=function(){return this.pidType===s.PID_TYPE.PHYSICAL1||this.pidType===s.PID_TYPE.PHYSICAL2},e.prototype.isChemical=function(){return this.pidType===s.PID_TYPE.CHEMICAL1||this.pidType===s.PID_TYPE.CHEMICAL2},e.prototype.isBiological=function(){return this.pidType===s.PID_TYPE.BIOLOGICAL1||this.pidType===s.PID_TYPE.BIOLOGICAL2},e.prototype.isPhysicalAdd=function(){return this.pidType===s.PID_TYPE.PHYSICAL_ADD},e.prototype.isChemicalAdd=function(){return this.pidType===s.PID_TYPE.CHEMICAL_ADD},Object.defineProperty(e.prototype,"xkDebugSettings",{get:function(){return this.debugSettings[this.xkType]},enumerable:!0,configurable:!0}),e}(i);e.SDKBase=u},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}(o(2))},function(t,e,o){"use strict";function n(){}function i(t,e,o){this.fn=t,this.context=e,this.once=o||!1}function r(t,e,o,n,r){if("function"!=typeof o)throw new TypeError("The listener must be a function");var s=new i(o,n||t,r),p=u?u+e:e;return t._events[p]?t._events[p].fn?t._events[p]=[t._events[p],s]:t._events[p].push(s):(t._events[p]=s,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function p(){this._events=new n,this._eventsCount=0}var a=Object.prototype.hasOwnProperty,u="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(u=!1)),p.prototype.eventNames=function(){var t,e,o=[];if(0===this._eventsCount)return o;for(e in t=this._events)a.call(t,e)&&o.push(u?e.slice(1):e);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},p.prototype.listeners=function(t){var e=u?u+t:t,o=this._events[e];if(!o)return[];if(o.fn)return[o.fn];for(var n=0,i=o.length,r=new Array(i);n<i;n++)r[n]=o[n].fn;return r},p.prototype.listenerCount=function(t){var e=u?u+t:t,o=this._events[e];return o?o.fn?1:o.length:0},p.prototype.emit=function(t,e,o,n,i,r){var s=u?u+t:t;if(!this._events[s])return!1;var p,a,c=this._events[s],_=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),_){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,o),!0;case 4:return c.fn.call(c.context,e,o,n),!0;case 5:return c.fn.call(c.context,e,o,n,i),!0;case 6:return c.fn.call(c.context,e,o,n,i,r),!0}for(a=1,p=new Array(_-1);a<_;a++)p[a-1]=arguments[a];c.fn.apply(c.context,p)}else{var E,l=c.length;for(a=0;a<l;a++)switch(c[a].once&&this.removeListener(t,c[a].fn,void 0,!0),_){case 1:c[a].fn.call(c[a].context);break;case 2:c[a].fn.call(c[a].context,e);break;case 3:c[a].fn.call(c[a].context,e,o);break;case 4:c[a].fn.call(c[a].context,e,o,n);break;default:if(!p)for(E=1,p=new Array(_-1);E<_;E++)p[E-1]=arguments[E];c[a].fn.apply(c[a].context,p)}}return!0},p.prototype.on=function(t,e,o){return r(this,t,e,o,!1)},p.prototype.once=function(t,e,o){return r(this,t,e,o,!0)},p.prototype.removeListener=function(t,e,o,n){var i=u?u+t:t;if(!this._events[i])return this;if(!e)return s(this,i),this;var r=this._events[i];if(r.fn)r.fn!==e||n&&!r.once||o&&r.context!==o||s(this,i);else{for(var p=0,a=[],c=r.length;p<c;p++)(r[p].fn!==e||n&&!r[p].once||o&&r[p].context!==o)&&a.push(r[p]);a.length?this._events[i]=1===a.length?a[0]:a:s(this,i)}return this},p.prototype.removeAllListeners=function(t){var e;return t?(e=u?u+t:t,this._events[e]&&s(this,e)):(this._events=new n,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=u,p.EventEmitter=p,t.exports=p},function(t,o){t.exports=e},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=o(8),s=o(3),p=o(0),a=function(t){function e(){var e=t.call(this)||this;return e.DEBUG=!1,e.addListeners(),e}return n(e,t),e.prototype.setConfig=function(e){t.prototype.setConfig.call(this,i.extend(e)),this.addDocHost=this.DOC_DEBUG?r.host.ADD_DOC_HOST_DEBUG:r.host.ADD_DOC_HOST,this.freshPidConfig();for(var o=0,n=Object.keys(r.docURL);o<n.length;o++){var s=n[o];r.docURL[s]=this.addDocHost+r.docURL[s]}console.log("************debugPlayerHost:",this.debugPlayerHost),this.debugPlayerHost.length?(this.playerHost=this.debugPlayerHost,this.playerHost=this.playerHost.replace("https","http")):this.playerHost=r.host[this.pidType].PLAYER_HOST},e.prototype.freshPidConfig=function(){this.pid=p.PID_VALUE[this.pidType],this.iconHost=r.host[this.pidType].ICON_HOST},e.prototype.switchSubject=function(t){this.pidType=t.pidType,this.freshPidConfig()},e.prototype.addListeners=function(){var t=this;window.addEventListener("message",function(e){var o=e.data||{};switch(console.log("~~~~~~~~~~~~~~~~~~~~~~message:",o),o.type){case p.MESSAGE_TYPE.NOBOOK_SUBMIT_RESPONSE:t._saveExam_resolve&&(t._saveExam_resolve(o),t._saveExam_resolve=null);break;case p.MESSAGE_TYPE.NOBOOK_ONE_STEP_CORRECT:case p.MESSAGE_TYPE.NOBOOK_ONE_STEP_WRONG:case p.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_TITLE:case p.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_COMPLETE:case p.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_PROGRESS:t.emit(o.type,e)}})},e.prototype.saveExam=function(t){var e=this;return this._saveExam_resolve?Promise.resolve({success:!1,msg:"已有提交请求处于队列中，此次提交失败"}):new Promise(function(o){e._saveExam_resolve=o;var n={type:p.MESSAGE_TYPE.NOBOOK_SUBMIT};n.params={time_length:t.timeLength,exam_sn:t.examSn},console.log("~~~~~~~~postMessage 提交:",n),t.iframeWindow.postMessage(n,"*")})},e.prototype.getAllLabPidScope=function(){var t=[];return[p.PID_TYPE.PHYSICAL_ADD,p.PID_TYPE.CHEMICAL_ADD].forEach(function(e){t.push(p.PID_VALUE[e])}),t.join(",")},e.prototype.getCourseList=function(t){var e=this;return t=t||{},this.$get(r.docURL.courseListURL,{token:this.token,pid:this.pid,page:t.page,limit:t.limit}).then(function(t){var o=i.get(t,"data.data");return"[object Array]"===Object.prototype.toString.call(o)&&o.forEach(function(t){t.thumbnailfull=e.iconHost+"/"+t.thumbnail}),t})},e.prototype.publishExam=function(t){return this.$post(r.docURL.publishExamURL,{token:this.token,pid:this.pid,exam_name:t.examName,course_ids:t.courseIds})},e.prototype.pubLishList=function(){return this.$get(r.docURL.pubLishListURL,{token:this.token,pid:this.pid})},e.prototype.getCourseInfo=function(t){return this.$get(r.docURL.courseInfoURL,{token:this.token,pid:this.pid,course_id:t.courseId})},e.prototype.saveExamResult=function(t){return this.$post(r.docURL.saveExamResultURL,{token:this.token,pid:this.pid,exam_sn:t.examSn,course_relation_id:t.courseRelationId,used_time:t.usedTime,steps:t.steps})},e.prototype.getStudentExamList=function(t){return this.$get(r.docURL.studentExamListURL,{token:this.token,pid:this.pid,exam_sn:t.examSn,course_relation_id:t.courseRelationId,page:t.page,limit:t.limit})},e.prototype.getStudentExamInfo=function(t){return this.$get(r.docURL.studentExamInfoURL,{pid:this.pid,token:this.token,test_id:t.testId})},e.prototype.getExamViewURL=function(t){return t.hasOwnProperty("isexam")||(t.isexam=1),this.playerHost+"?relationid="+t.courseId+"&token="+this.token+"&isexam="+t.isexam+"&pid="+this.pid},Object.defineProperty(e.prototype,"debugPlayerHost",{get:function(){return""+i.get(this.xkDebugSettings,"PLAYER","")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playerDoc",{get:function(){return!!this.debugPlayerHost.length&&i.get(this.xkDebugSettings,"PLAYER_DOC",!0)},enumerable:!0,configurable:!0}),e}(s.SDKBase);e.AdditionalSDK=a},,function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.host={ADD_DOC_HOST:"https://exam-app.nobook.com",ADD_DOC_HOST_DEBUG:"http://exam-app.nobook.cc",PHYSICAL_ADD:{ICON_HOST:"https://imgcdn.nobook.com/exam/resource/addicomponents/v1/assets/physics",PLAYER_HOST:"https://exam-phy-playercdn.nobook.com"},CHEMICAL_ADD:{ICON_HOST:"xxxxxxxxxxx",PLAYER_HOST:"xxxxxxxxxxx"}},e.docURL={courseListURL:"/api/v2/exam/courselist",publishExamURL:"/api/v2/exam/publishexam",pubLishListURL:"/api/v2/exam/publishlist",courseInfoURL:"/api/v2/exam/courseinfo",saveExamResultURL:"/api/v2/exam/saveexamresult",studentExamListURL:"/api/v2/exam/studentexamlist",studentExamInfoURL:"/api/v2/exam/studentexaminfo"}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(6);e.AdditionalSDK=n.AdditionalSDK;var i=o(0);e.APPKEY_TEST=i.APPKEY_TEST,e.APPSECRET_TEST=i.APPSECRET_TEST,e.PID_TYPE=i.PID_TYPE,e.MESSAGE_TYPE=i.MESSAGE_TYPE,"object"==typeof window&&(window.NB_SDK_ADDITIONAL={APPKEY_TEST:i.APPKEY_TEST,APPSECRET_TEST:i.APPSECRET_TEST,AdditionalSDK:n.AdditionalSDK,MESSAGE_TYPE:i.MESSAGE_TYPE})}])});