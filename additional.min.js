(function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("jQuery"),require("lodash"));else if("function"==typeof define&&define.amd)define(["jQuery","lodash"],e);else{var o="object"==typeof exports?e(require("jQuery"),require("lodash")):e(t.jQuery,t._);for(var n in o)("object"==typeof exports?exports:t)[n]=o[n]}})(this,function(t,e){return function(t){function e(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=9)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.APPKEY_TEST="111",e.APPSECRET_TEST="weqwew",e.PID_TYPE={PHYSICAL1:"PHYSICAL1",PHYSICAL2:"PHYSICAL2",CHEMICAL1:"CHEMICAL1",CHEMICAL2:"CHEMICAL2",BIOLOGICAL1:"BIOLOGICAL1",BIOLOGICAL2:"BIOLOGICAL2",PHYSICAL_ADD:"PHYSICAL_ADD",CHEMICAL_ADD:"CHEMICAL_ADD"},e.PID_VALUE={PHYSICAL1:{lab:"CZWlTE4lVgz9",source:"RESCZWLEeqji"},PHYSICAL2:{lab:"GZWLcJQXfD9W",source:"RESGZWLZoxY5"},CHEMICAL1:{lab:"CZHXNDZHTa75",source:"RESCZHX8afQ1"},CHEMICAL2:{lab:"GZHXXV8IClkO",source:"RESGZHX54req"},BIOLOGICAL1:{source:"JuFhE84jRhEh"},BIOLOGICAL2:{source:"EjEViMk33jNr"},PHYSICAL_ADD:"dd884e33339c29a5721e827eafd9039d",CHEMICAL_ADD:"10822dc066ee1da448c3da1936a21f49"},e.MESSAGE_TYPE={SAVE_DATA:"PHYSICS_SDK_INTERFACE_SAVE",SAVE_DATA_RESPONSE:"PHYSICS_SDK_INTERFACE_SAVE_RESPONSE",NOBOOK_SUBMIT:"nobook.submit",NOBOOK_SUBMIT_RESPONSE:"nobook.submit_response",NOBOOK_ONE_STEP:"nobook.oneStepCorrect",NOBOOK_PRACICE_ONE_TITLE:"nobook.oneStepTitle",NOBOOK_PRACICE_ONE_COMPLETE:"nobook.oneStepComplete",NOBOOK_PRACICE_ONE_PROGRESS:"nobook.oneStepProgress",PHYSICS_SDK_INTERFACE_FRESH_DATA:"PHYSICS_SDK_INTERFACE_FRESH_DATA",ON_LOAD:"onload"},e.GLOBAL_HOST={DOC_HOST:"https://resourceapi.nobook.com",DOC_HOST_DEBUG:"http://resourceapi.nobook.cc"},e.GLOBAL_DOCURL={loginURL:"/api/v1/login",logoutURL:"/api/v1/logout"}},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=o(3),s=o(4),i=o(0),a=function(t){function e(){var e=t.call(this)||this;return e.DEBUG=!1,e.token=null,e}return n(e,t),e.prototype.setConfig=function(t){this.DEBUG=t.DEBUG,this.appKey=t.appKey,this.pidType=t.pidType,this.docHost=t.DEBUG?i.GLOBAL_HOST.DOC_HOST_DEBUG:i.GLOBAL_HOST.DOC_HOST;for(var e=0,o=Object.keys(i.GLOBAL_DOCURL);e<o.length;e++){var n=o[e];i.GLOBAL_DOCURL[n]=this.docHost+i.GLOBAL_DOCURL[n]}},e.prototype.login=function(t){var e=this;this.nickname=t.nickname;var o={appKey:this.appKey,uniqueId:t.uniqueId,timestamp:t.timestamp,sign:t.sign,nickname:t.nickname,pidScope:t.pidScope,usertype:0};return this.$post(i.GLOBAL_DOCURL.loginURL,o).then(function(t){var o=t.data;return e.token=o.token,e.uid=o.userinfo.userid,t})},e.prototype.logout=function(){return this.$post(i.GLOBAL_DOCURL.logoutURL,{token:this.token})},e.prototype.$get=function(t,e){return this.$server({method:"get",url:t,param:e})},e.prototype.$post=function(t,e){return this.$server({method:"post",url:t,param:e})},e.prototype.$server=function(t){var e=this;return new Promise(function(o,n){s[t.method](t.url,t.param,function(t,r){if("success"===r){var s=e.jsonObj(t);if(0===s.code){var i=s.data;o({success:!0,data:i})}else n({success:!1,msg:s.msg})}else n({success:!1,msg:r})})})},e.prototype.jsonObj=function(t){return"[object String]"===Object.prototype.toString.call(t)?JSON.parse(t):t},e.prototype.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e}(r);e.SDKBase=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}(o(1))},function(t,e,o){"use strict";function n(){}function r(t,e,o){this.fn=t,this.context=e,this.once=o||!1}function s(t,e,o,n,s){if("function"!=typeof o)throw new TypeError("The listener must be a function");var i=new r(o,n||t,s),a=u?u+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],i]:t._events[a].push(i):(t._events[a]=i,t._eventsCount++),t}function i(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}var c=Object.prototype.hasOwnProperty,u="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(u=!1)),a.prototype.eventNames=function(){var t,e,o=[];if(0===this._eventsCount)return o;for(e in t=this._events)c.call(t,e)&&o.push(u?e.slice(1):e);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=u?u+t:t,o=this._events[e];if(!o)return[];if(o.fn)return[o.fn];for(var n=0,r=o.length,s=new Array(r);n<r;n++)s[n]=o[n].fn;return s},a.prototype.listenerCount=function(t){var e=u?u+t:t,o=this._events[e];return o?o.fn?1:o.length:0},a.prototype.emit=function(t,e,o,n,r,s){var i=u?u+t:t;if(!this._events[i])return!1;var a,c,p=this._events[i],_=arguments.length;if(p.fn){switch(p.once&&this.removeListener(t,p.fn,void 0,!0),_){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,e),!0;case 3:return p.fn.call(p.context,e,o),!0;case 4:return p.fn.call(p.context,e,o,n),!0;case 5:return p.fn.call(p.context,e,o,n,r),!0;case 6:return p.fn.call(p.context,e,o,n,r,s),!0}for(c=1,a=new Array(_-1);c<_;c++)a[c-1]=arguments[c];p.fn.apply(p.context,a)}else{var E,f=p.length;for(c=0;c<f;c++)switch(p[c].once&&this.removeListener(t,p[c].fn,void 0,!0),_){case 1:p[c].fn.call(p[c].context);break;case 2:p[c].fn.call(p[c].context,e);break;case 3:p[c].fn.call(p[c].context,e,o);break;case 4:p[c].fn.call(p[c].context,e,o,n);break;default:if(!a)for(E=1,a=new Array(_-1);E<_;E++)a[E-1]=arguments[E];p[c].fn.apply(p[c].context,a)}}return!0},a.prototype.on=function(t,e,o){return s(this,t,e,o,!1)},a.prototype.once=function(t,e,o){return s(this,t,e,o,!0)},a.prototype.removeListener=function(t,e,o,n){var r=u?u+t:t;if(!this._events[r])return this;if(!e)return i(this,r),this;var s=this._events[r];if(s.fn)s.fn!==e||n&&!s.once||o&&s.context!==o||i(this,r);else{for(var a=0,c=[],p=s.length;a<p;a++)(s[a].fn!==e||n&&!s[a].once||o&&s[a].context!==o)&&c.push(s[a]);c.length?this._events[r]=1===c.length?c[0]:c:i(this,r)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=u?u+t:t,this._events[e]&&i(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=u,a.EventEmitter=a,t.exports=a},function(e,o){e.exports=t},function(t,o){t.exports=e},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=o(5),s=o(8),i=o(2),a=o(0),c=function(t){function e(){var e=t.call(this)||this;return e.DEBUG=!1,e.addListeners(),e}return n(e,t),e.prototype.setConfig=function(e){t.prototype.setConfig.call(this,r.extend(e)),this.addDocHost=e.DEBUG?s.host.ADD_DOC_HOST_DEBUG:s.host.ADD_DOC_HOST,this.freshPidConfig();for(var o=0,n=Object.keys(s.docURL);o<n.length;o++){var i=n[o];s.docURL[i]=this.addDocHost+s.docURL[i]}e.EXAM_VIEW_HOST_DEBUG&&(s.host.EXAM_VIEW_HOST=e.EXAM_VIEW_HOST_DEBUG),e.ICON_HOST_PHYSICAL_DEBUG&&(s.host[a.PID_TYPE.PHYSICAL_ADD].ICON_HOST=e.ICON_HOST_PHYSICAL_DEBUG),e.ICON_HOST_CHEMICAL_DEBUG&&(s.host[a.PID_TYPE.CHEMICAL_ADD].ICON_HOST=e.ICON_HOST_CHEMICAL_DEBUG)},e.prototype.freshPidConfig=function(){this.pid=a.PID_VALUE[this.pidType],this.iconHost=s.host[this.pidType].ICON_HOST},e.prototype.switchSubject=function(t){this.pidType=t.pidType,this.freshPidConfig()},e.prototype.addListeners=function(){var t=this;window.addEventListener("message",function(e){var o=e.data||{};switch(o.type){case a.MESSAGE_TYPE.NOBOOK_SUBMIT_RESPONSE:t._saveExam_resolve&&(t._saveExam_resolve(o.result),t._saveExam_resolve=null);break;case a.MESSAGE_TYPE.NOBOOK_ONE_STEP:case a.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_TITLE:case a.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_COMPLETE:case a.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_PROGRESS:t.emit(o.type,e)}})},e.prototype.saveExam=function(t){var e=this;return this._saveExam_resolve?Promise.resolve({success:!1,msg:"已有提交请求处于队列中，此次提交失败"}):new Promise(function(o){e._saveExam_resolve=o;var n={type:a.MESSAGE_TYPE.NOBOOK_SUBMIT};n.params={time_length:t.timeLength,exam_sn:t.examSn},t.iframeWindow.postMessage(n,"*")})},e.prototype.getAllLabPidScope=function(){var t=[];return[a.PID_TYPE.PHYSICAL_ADD,a.PID_TYPE.CHEMICAL_ADD].forEach(function(e){t.push(a.PID_VALUE[e])}),t.join(",")},e.prototype.getCourseList=function(t){var e=this;return t=t||{},this.$get(s.docURL.courseListURL,{token:this.token,pid:this.pid,page:t.page,limit:t.limit}).then(function(t){var o=r.get(t,"data.data");return"[object Array]"===Object.prototype.toString.call(o)&&o.forEach(function(t){t.thumbnailfull=e.iconHost+"/"+t.thumbnail}),t})},e.prototype.publishExam=function(t){return this.$post(s.docURL.publishExamURL,{token:this.token,pid:this.pid,exam_name:t.examName,course_ids:t.courseIds})},e.prototype.pubLishList=function(){return this.$get(s.docURL.pubLishListURL,{token:this.token,pid:this.pid})},e.prototype.getCourseInfo=function(t){return this.$get(s.docURL.courseInfoURL,{token:this.token,pid:this.pid,course_id:t.courseId})},e.prototype.saveExamResult=function(t){return this.$post(s.docURL.saveExamResultURL,{token:this.token,pid:this.pid,exam_sn:t.examSn,course_relation_id:t.courseRelationId,used_time:t.usedTime,steps:t.steps})},e.prototype.getStudentExamList=function(t){return this.$get(s.docURL.studentExamListURL,{token:this.token,pid:this.pid,exam_sn:t.examSn,course_relation_id:t.courseRelationId,page:t.page,limit:t.limit})},e.prototype.getStudentExamInfo=function(t){return this.$get(s.docURL.studentExamInfoURL,{token:this.token,test_id:t.testId})},e.prototype.getExamViewURL=function(t){return t.hasOwnProperty("isexam")||(t.isexam=1),s.host.EXAM_VIEW_HOST+"?relationid="+t.courseId+"&token="+this.token+"&isexam="+t.isexam+"&pid="+this.pid},e}(i.SDKBase);e.AdditionalSDK=c},,function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.host={ADD_DOC_HOST:"http://exam-app.nobook.com",ADD_DOC_HOST_DEBUG:"http://exam-app.nobook.cc",PHYSICAL_ADD:{ICON_HOST:"http://addphys.nobook.cc/v1/assets/physics"},CHEMICAL_ADD:{ICON_HOST:"xxxxxxxxxxx"},EXAM_VIEW_HOST:""},e.docURL={courseListURL:"/api/v2/exam/courselist",publishExamURL:"/api/v2/exam/publishexam",pubLishListURL:"/api/v2/exam/publishlist",courseInfoURL:"/api/v2/exam/courseinfo",saveExamResultURL:"/api/v2/exam/saveexamresult",studentExamListURL:"/api/v2/exam/studentexamlist",studentExamInfoURL:"/api/v2/exam/studentexaminfo"}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(6);e.AdditionalSDK=n.AdditionalSDK;var r=o(0);e.APPKEY_TEST=r.APPKEY_TEST,e.APPSECRET_TEST=r.APPSECRET_TEST,e.PID_TYPE=r.PID_TYPE,e.MESSAGE_TYPE=r.MESSAGE_TYPE,"object"==typeof window&&(window.NB_SDK_ADDITIONAL={APPKEY_TEST:r.APPKEY_TEST,APPSECRET_TEST:r.APPSECRET_TEST,AdditionalSDK:n.AdditionalSDK,MESSAGE_TYPE:r.MESSAGE_TYPE})}])});