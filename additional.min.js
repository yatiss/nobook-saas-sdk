(function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("lodash"),require("jQuery"));else if("function"==typeof define&&define.amd)define(["lodash","jQuery"],t);else{var o="object"==typeof exports?t(require("lodash"),require("jQuery")):t(e._,e.jQuery);for(var n in o)("object"==typeof exports?exports:e)[n]=o[n]}})(this,function(e,t){return function(e){function t(n){if(o[n])return o[n].exports;var s=o[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(t,o){t.exports=e},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),s=window.__nb_saas_sdk_config;t.APPKEY_TEST="111",t.APPSECRET_TEST="weqwew",t.PID_TYPE={PHYSICAL1:"PHYSICAL1",PHYSICAL2:"PHYSICAL2",CHEMICAL1:"CHEMICAL1",CHEMICAL2:"CHEMICAL2",BIOLOGICAL1:"BIOLOGICAL1",BIOLOGICAL2:"BIOLOGICAL2",PHYSICAL_ADD:"PHYSICAL_ADD",CHEMICAL_ADD:"CHEMICAL_ADD"},t.LAB_TYPE_GRADE={PHYSICAL1:1,PHYSICAL2:2,CHEMICAL1:1,CHEMICAL2:2,BIOLOGICAL1:1,BIOLOGICAL2:2},t.PID_VALUE={PHYSICAL1:{lab:"CZWlTE4lVgz9",source:"RESCZWLEeqji"},PHYSICAL2:{lab:"GZWLcJQXfD9W",source:"RESGZWLZoxY5"},CHEMICAL1:{lab:"CZHXNDZHTa75",source:"RESCZHX8afQ1"},CHEMICAL2:{lab:"GZHXXV8IClkO",source:"RESGZHX54req"},BIOLOGICAL1:{source:"JuFhE84jRhEh"},BIOLOGICAL2:{source:"EjEViMk33jNr"},PHYSICAL_ADD:"EXAMQGWLuC5K",CHEMICAL_ADD:"EXAMQGHXuC5K"},t.MESSAGE_TYPE={SAVE_DATA:"PHYSICS_SDK_INTERFACE_SAVE",SAVE_DATA_RESPONSE:"PHYSICS_SDK_INTERFACE_SAVE_RESPONSE",DATA_REQUEST:"PHYSICS_SDK_INTERFACE_DATA_REQUEST",DATA_REQUEST_RESPONSE:"PHYSICS_SDK_INTERFACE_DATA_REQUEST_RESPONSE",NOBOOK_SUBMIT:"nobook.submit",NOBOOK_SUBMIT_RESPONSE:"nobook.submit_response",NOBOOK_ONE_STEP_CORRECT:"nobook.oneStepCorrect",NOBOOK_ONE_STEP_WRONG:"nobook.oneStepWrong",NOBOOK_PRACICE_ONE_TITLE:"nobook.oneStepTitle",NOBOOK_PRACICE_ONE_COMPLETE:"nobook.oneStepComplete",NOBOOK_PRACICE_ONE_PROGRESS:"nobook.oneStepProgress",PHYSICS_SDK_INTERFACE_FRESH_DATA:"PHYSICS_SDK_INTERFACE_FRESH_DATA",ON_LOAD:"onload",ON_LOAD_ERROR:"load_error"},t.GLOBAL_HOST={DOC_HOST:"https://resourceapi.nobook.com",DOC_HOST_DEBUG:"http://resourceapi.nobook.cc"},n.merge(t.GLOBAL_HOST,s),t.GLOBAL_DOCURL={loginURL:"/api/v1/login",logoutURL:"/api/v1/logout"}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),s=window.__nb_saas_sdk_config;t.host={PHYSICAL1:{EDIT_END_NAME:"physics-courseware",ICON_HOST:"https://wuli.nobook.com",EDIT_HOST:"https://wuli.nobook.com",PLAYER_HOST:"https://wuliplayercdn.nobook.com"},PHYSICAL2:{EDIT_END_NAME:"physics-courseware",ICON_HOST:"https://wuli.nobook.com",EDIT_HOST:"https://wuli.nobook.com",PLAYER_HOST:"https://wuliplayercdn.nobook.com"},CHEMICAL1:{EDIT_END_NAME:"chemical-courseware",ICON_HOST:"https://huaxue.nobook.com",EDIT_HOST:"https://huaxue.nobook.com",PLAYER_HOST:"https://huaxueplayercdn.nobook.com"},CHEMICAL2:{EDIT_END_NAME:"chemical-courseware",ICON_HOST:"https://huaxue.nobook.com",EDIT_HOST:"https://huaxue.nobook.com",PLAYER_HOST:"https://huaxueplayercdn.nobook.com"},BIOLOGICAL1:{ICON_HOST:"https://res-api.nobook.com/sw/cz/libs/biology",PLAYER_HOST:"https://shengwuv2-cz.nobook.com/libs/biology",PLAYER_HOST_DEBUG:"http://shengwu-cz.nobook.cc/libs/biology"},BIOLOGICAL2:{ICON_HOST:"https://res-api.nobook.com/sw/gz/libs/biology",PLAYER_HOST:"https://shengwuv2-gz.nobook.com/libs/biology",PLAYER_HOST_DEBUG:"http://shengwu-gz.nobook.cc/libs/biology"}},s&&s.host&&n.merge(t.host,s.host),t.docURL={searchDIYURL:"/api/v1/myexperiment/search",getListDIYURL:"/api/v1/myexperiment/get",delLabDataDIYURL:"/api/v1/myexperiment/del",renameDIYURL:"/api/v1/myexperiment/rename",shareDIYURL:"/api/v1/myexperiment/share",getInfoDIYURL:"/api/v1/myexperiment/info",clearRedisURL:"/api/v1/myexperiment/clearCache",migrationURL:"/api/v1/myexperiment/migration",copyDIYURL:"/api/v1/myexperiment/copy",getResourcesByChapterURL:"/api/v1/resources/listbychapterid",getResourcesByCategoryURL:"/api/v1/resources/listbycategoryid",getChapterURL:"/api/v1/resources/chapter",classificationsURL:"/api/v1/resources/experimentcategory",searchResourcesURL:"/api/v1/resources/search",getInfoResourcesURL:"/api/v1/resources/info",copyResourcesURL:"/api/v1/resources/copy"}},function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=o(5),i=o(6),r=o(1),c=o(0),a=o(2),p=function(e){function t(){var t=e.call(this)||this;return t.DOC_DEBUG=!1,t.isMobile=!1,t.token=null,t}return n(t,e),t.prototype.setConfig=function(e){this.hostSettings=e.hostSettings||{},this.appKey=e.appKey,this.pidType=e.pidType,this.isMobile=e.isMobile,e.hostSettings&&(this.docHost=c.get(e.hostSettings,"DOC_HOST",r.GLOBAL_HOST.DOC_HOST),["PHYSICAL1","PHYSICAL2","CHEMICAL1","CHEMICAL2","BIOLOGICAL1","BIOLOGICAL2"].map(function(t){var o={PHYSICAL1:"PHYSICAL",PHYSICAL2:"PHYSICAL",CHEMICAL1:"CHEMICAL",CHEMICAL2:"CHEMICAL",BIOLOGICAL1:"BIOLOGICAL",BIOLOGICAL2:"BIOLOGICAL"}[t];c.merge(a.host[t],e.hostSettings[o])})),e.docHost&&(this.docHost=e.docHost);for(var t=0,o=Object.keys(r.GLOBAL_DOCURL);t<o.length;t++){var n=o[t];r.GLOBAL_DOCURL[n]=this.docHost+r.GLOBAL_DOCURL[n]}},t.prototype.login=function(e){var t=this;this.nickname=e.nickname;var o={appKey:this.appKey,uniqueId:e.uniqueId,timestamp:e.timestamp,sign:e.sign,nickname:e.nickname,pidScope:e.pidScope,usertype:0};return this.$post(r.GLOBAL_DOCURL.loginURL,o).then(function(e){var o=e.data;return t.token=o.token,t.uid=o.userinfo.userid,e})},t.prototype.logout=function(){return this.$post(r.GLOBAL_DOCURL.logoutURL,{token:this.token})},t.prototype.$get=function(e,t){return this.$server({method:"get",url:e,param:t})},t.prototype.$post=function(e,t){return this.$server({method:"post",url:e,param:t})},t.prototype.$server=function(e){var t=this;return new Promise(function(o,n){i[e.method](e.url,e.param,function(e,s){if("success"===s){var i=t.jsonObj(e);if(0===i.code){var r=i.data;o({success:!0,data:r})}else n({success:!1,msg:i.msg})}else n({success:!1,msg:s})})})},t.prototype.jsonObj=function(e){return"[object String]"===Object.prototype.toString.call(e)?JSON.parse(e):e},t.prototype.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},Object.defineProperty(t.prototype,"grade",{get:function(){return r.LAB_TYPE_GRADE[this.pidType]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xkType",{get:function(){return this.isPhysical()?"PHYSICAL":this.isChemical()?"CHEMICAL":this.isBiological()?this.pidType:this.isPhysicalAdd()?"PHYSICAL_ADD":this.isChemicalAdd()?"CHEMICAL_ADD":null},enumerable:!0,configurable:!0}),t.prototype.isPhysical=function(){return this.pidType===r.PID_TYPE.PHYSICAL1||this.pidType===r.PID_TYPE.PHYSICAL2},t.prototype.isChemical=function(){return this.pidType===r.PID_TYPE.CHEMICAL1||this.pidType===r.PID_TYPE.CHEMICAL2},t.prototype.isBiological=function(){return this.pidType===r.PID_TYPE.BIOLOGICAL1||this.pidType===r.PID_TYPE.BIOLOGICAL2},t.prototype.isPhysicalAdd=function(){return this.pidType===r.PID_TYPE.PHYSICAL_ADD},t.prototype.isChemicalAdd=function(){return this.pidType===r.PID_TYPE.CHEMICAL_ADD},Object.defineProperty(t.prototype,"xkHostSettings",{get:function(){return this.hostSettings[this.xkType]},enumerable:!0,configurable:!0}),t}(s);t.SDKBase=p},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}(o(3))},function(e,t,o){"use strict";function n(){}function s(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function i(e,t,o,n,i){if("function"!=typeof o)throw new TypeError("The listener must be a function");var r=new s(o,n||e,i),c=p?p+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],r]:e._events[c].push(r):(e._events[c]=r,e._eventsCount++),e}function r(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function c(){this._events=new n,this._eventsCount=0}var a=Object.prototype.hasOwnProperty,p="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(p=!1)),c.prototype.eventNames=function(){var e,t,o=[];if(0===this._eventsCount)return o;for(t in e=this._events)a.call(e,t)&&o.push(p?t.slice(1):t);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},c.prototype.listeners=function(e){var t=p?p+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var n=0,s=o.length,i=new Array(s);n<s;n++)i[n]=o[n].fn;return i},c.prototype.listenerCount=function(e){var t=p?p+e:e,o=this._events[t];return o?o.fn?1:o.length:0},c.prototype.emit=function(e,t,o,n,s,i){var r=p?p+e:e;if(!this._events[r])return!1;var c,a,u=this._events[r],_=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),_){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,o),!0;case 4:return u.fn.call(u.context,t,o,n),!0;case 5:return u.fn.call(u.context,t,o,n,s),!0;case 6:return u.fn.call(u.context,t,o,n,s,i),!0}for(a=1,c=new Array(_-1);a<_;a++)c[a-1]=arguments[a];u.fn.apply(u.context,c)}else{var h,E=u.length;for(a=0;a<E;a++)switch(u[a].once&&this.removeListener(e,u[a].fn,void 0,!0),_){case 1:u[a].fn.call(u[a].context);break;case 2:u[a].fn.call(u[a].context,t);break;case 3:u[a].fn.call(u[a].context,t,o);break;case 4:u[a].fn.call(u[a].context,t,o,n);break;default:if(!c)for(h=1,c=new Array(_-1);h<_;h++)c[h-1]=arguments[h];u[a].fn.apply(u[a].context,c)}}return!0},c.prototype.on=function(e,t,o){return i(this,e,t,o,!1)},c.prototype.once=function(e,t,o){return i(this,e,t,o,!0)},c.prototype.removeListener=function(e,t,o,n){var s=p?p+e:e;if(!this._events[s])return this;if(!t)return r(this,s),this;var i=this._events[s];if(i.fn)i.fn!==t||n&&!i.once||o&&i.context!==o||r(this,s);else{for(var c=0,a=[],u=i.length;c<u;c++)(i[c].fn!==t||n&&!i[c].once||o&&i[c].context!==o)&&a.push(i[c]);a.length?this._events[s]=1===a.length?a[0]:a:r(this,s)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=p?p+e:e,this._events[t]&&r(this,t)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=p,c.EventEmitter=c,e.exports=c},function(e,o){e.exports=t},function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),i=o(9),r=o(4),c=o(1),a=function(e){function t(){var t=e.call(this)||this;return t.DEBUG=!1,t.addListeners(),t}return n(t,e),t.prototype.setConfig=function(t){e.prototype.setConfig.call(this,s.extend(t)),this.addDocHost=this.DOC_DEBUG?i.host.ADD_DOC_HOST_DEBUG:i.host.ADD_DOC_HOST,this.freshPidConfig();for(var o=0,n=Object.keys(i.docURL);o<n.length;o++){var r=n[o];i.docURL[r]=this.addDocHost+i.docURL[r]}console.log("************debugPlayerHost:",this.debugPlayerHost),this.debugPlayerHost.length?(this.playerHost=this.debugPlayerHost,this.playerHost=this.playerHost.replace("https","http")):this.playerHost=i.host[this.pidType].PLAYER_HOST},t.prototype.freshPidConfig=function(){this.pid=c.PID_VALUE[this.pidType],this.iconHost=i.host[this.pidType].ICON_HOST},t.prototype.switchSubject=function(e){this.pidType=e.pidType,this.freshPidConfig()},t.prototype.addListeners=function(){var e=this;window.addEventListener("message",function(t){var o=t.data||{};switch(console.log("~~~~~~~~~~~~~~~~~~~~~~message:",o),o.type){case c.MESSAGE_TYPE.NOBOOK_SUBMIT_RESPONSE:e._saveExam_resolve&&(e._saveExam_resolve(o),e._saveExam_resolve=null);break;case c.MESSAGE_TYPE.NOBOOK_ONE_STEP_CORRECT:case c.MESSAGE_TYPE.NOBOOK_ONE_STEP_WRONG:case c.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_TITLE:case c.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_COMPLETE:case c.MESSAGE_TYPE.NOBOOK_PRACICE_ONE_PROGRESS:e.emit(o.type,t)}})},t.prototype.saveExam=function(e){var t=this;return this._saveExam_resolve?Promise.resolve({success:!1,msg:"已有提交请求处于队列中，此次提交失败"}):new Promise(function(o){t._saveExam_resolve=o;var n={type:c.MESSAGE_TYPE.NOBOOK_SUBMIT};n.params={time_length:e.timeLength,exam_sn:e.examSn},console.log("~~~~~~~~postMessage 提交:",n),e.iframeWindow.postMessage(n,"*")})},t.prototype.getAllLabPidScope=function(){var e=[];return[c.PID_TYPE.PHYSICAL_ADD,c.PID_TYPE.CHEMICAL_ADD].forEach(function(t){e.push(c.PID_VALUE[t])}),e.join(",")},t.prototype.getCourseList=function(e){var t=this;return e=e||{},this.$get(i.docURL.courseListURL,{token:this.token,pid:this.pid,page:e.page,limit:e.limit}).then(function(e){var o=s.get(e,"data.data");return"[object Array]"===Object.prototype.toString.call(o)&&o.forEach(function(e){e.thumbnailfull=t.iconHost+"/"+e.thumbnail}),e})},t.prototype.publishExam=function(e){return this.$post(i.docURL.publishExamURL,{token:this.token,pid:this.pid,exam_name:e.examName,course_ids:e.courseIds})},t.prototype.pubLishList=function(){return this.$get(i.docURL.pubLishListURL,{token:this.token,pid:this.pid})},t.prototype.getCourseInfo=function(e){return this.$get(i.docURL.courseInfoURL,{token:this.token,pid:this.pid,course_id:e.courseId})},t.prototype.saveExamResult=function(e){return this.$post(i.docURL.saveExamResultURL,{token:this.token,pid:this.pid,exam_sn:e.examSn,course_relation_id:e.courseRelationId,used_time:e.usedTime,steps:e.steps})},t.prototype.getStudentExamList=function(e){return this.$get(i.docURL.studentExamListURL,{token:this.token,pid:this.pid,exam_sn:e.examSn,course_relation_id:e.courseRelationId,page:e.page,limit:e.limit})},t.prototype.getStudentExamInfo=function(e){return this.$get(i.docURL.studentExamInfoURL,{pid:this.pid,token:this.token,test_id:e.testId})},t.prototype.getExamViewURL=function(e){return e.hasOwnProperty("isexam")||(e.isexam=1),this.playerHost+"?relationid="+e.courseId+"&token="+this.token+"&isexam="+e.isexam+"&pid="+this.pid},Object.defineProperty(t.prototype,"debugPlayerHost",{get:function(){return""+s.get(this.xkHostSettings,"PLAYER","")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playerDoc",{get:function(){return!!this.debugPlayerHost.length&&s.get(this.xkHostSettings,"PLAYER_DOC",!0)},enumerable:!0,configurable:!0}),t}(r.SDKBase);t.AdditionalSDK=a},,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.host={ADD_DOC_HOST:"https://exam-app.nobook.com",ADD_DOC_HOST_DEBUG:"http://exam-app.nobook.cc",PHYSICAL_ADD:{ICON_HOST:"https://imgcdn.nobook.com/exam/resource/addicomponents/v1/assets/physics",PLAYER_HOST:"https://exam-phy-playercdn.nobook.com"},CHEMICAL_ADD:{ICON_HOST:"xxxxxxxxxxx",PLAYER_HOST:"xxxxxxxxxxx"}},t.docURL={courseListURL:"/api/v2/exam/courselist",publishExamURL:"/api/v2/exam/publishexam",pubLishListURL:"/api/v2/exam/publishlist",courseInfoURL:"/api/v2/exam/courseinfo",saveExamResultURL:"/api/v2/exam/saveexamresult",studentExamListURL:"/api/v2/exam/studentexamlist",studentExamInfoURL:"/api/v2/exam/studentexaminfo"}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(7);t.AdditionalSDK=n.AdditionalSDK;var s=o(1);t.APPKEY_TEST=s.APPKEY_TEST,t.APPSECRET_TEST=s.APPSECRET_TEST,t.PID_TYPE=s.PID_TYPE,t.MESSAGE_TYPE=s.MESSAGE_TYPE,"object"==typeof window&&(window.NB_SDK_ADDITIONAL={APPKEY_TEST:s.APPKEY_TEST,APPSECRET_TEST:s.APPSECRET_TEST,AdditionalSDK:n.AdditionalSDK,MESSAGE_TYPE:s.MESSAGE_TYPE})}])});